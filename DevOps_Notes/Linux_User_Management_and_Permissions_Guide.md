# Linux 用户管理与权限配置指南

## 目录结构

1.  用户创建与家目录配置
2.  Shell环境修改
3.  密码设置
4.  Sudo权限配置
5.  命令详解

------------------------------------------------------------------------

## 1. 用户创建与家目录配置

### 操作命令

``` bash
sudo useradd -d /home/xhy -m xhy
```

### 参数说明

-   `-d`：指定用户主目录路径（本例为`/home/xhy`）
-   `-m`：当指定目录不存在时自动创建
-   末位参数：需创建的用户名（本例为`xhy`）

------------------------------------------------------------------------

## 2. Shell环境修改

### 操作命令

``` bash
sudo usermod -s /bin/bash xhy
```

### 功能说明

-   `usermod`：用户属性修改命令
-   `-s`：指定登录Shell类型
-   用途：将用户`xhy`的默认Shell从`sh`改为功能更强大的`bash`

------------------------------------------------------------------------

## 3. 用户密码设置

### 操作命令

``` bash
sudo passwd xhy
```

### 执行流程

1.  执行命令后进入交互界面
2.  连续输入两次新密码
3.  密码强度建议：包含大小写字母、数字和特殊字符

------------------------------------------------------------------------

## 4. Sudo权限配置

### 配置步骤

``` bash
# 1. 开启文件写权限
sudo chmod u+w /etc/sudoers

# 2. 编辑配置文件
sudo vi /etc/sudoers

# 3. 添加权限配置（在root配置下方插入）
xhy     ALL=(ALL:ALL) ALL

# 4. 恢复文件权限
sudo chmod u-w /etc/sudoers
```

### 安全提醒

-   推荐使用`visudo`命令替代直接编辑（自动语法检查）
-   权限修改后应立即恢复440权限

------------------------------------------------------------------------

## 5. 命令详解

### 5.1 `useradd` 深度解析

``` bash
useradd [选项] 用户名
```

-   常用组合参数：
    -   `-d` + `-m`：创建带指定目录的用户
    -   `-g`：指定主用户组
    -   `-G`：指定附加用户组

### 5.2 `usermod` 使用规范

``` bash
usermod [选项] 用户名
```

-   关键选项：
    -   `-s`：修改登录Shell
    -   `-L`：锁定用户账户
    -   `-U`：解锁用户账户

### 5.3 `passwd` 安全策略

-   管理员权限：root用户可修改任意用户密码
-   普通用户：仅能修改自身密码
-   密码策略文件：`/etc/login.defs`

### 5.4 `chmod` 权限管理

#### 语法结构

``` bash
chmod [ugoa][+-=][rwxX] 文件
```

#### 参数说明

| 参数 | 含义               |
|------|--------------------|
| u    | 文件所有者         |
| g    | 同组用户           |
| o    | 其他用户           |
| a    | 所有用户（默认值） |
| \+   | 增加权限           |
| \-   | 移除权限           |
| =    | 设置精确权限       |

#### 典型应用

``` bash
# 增加所有者写权限
sudo chmod u+w /etc/sudoers

# 移除所有者写权限
sudo chmod u-w /etc/sudoers
```

------------------------------------------------------------------------

## 注意事项

1.  用户创建后建议立即设置密码
2.  `/etc/sudoers`文件编辑需谨慎，语法错误可能导致系统权限故障
3.  生产环境建议使用`adduser`代替`useradd`（交互式创建）
4.  定期使用`passwd -S 用户名`检查密码状态
