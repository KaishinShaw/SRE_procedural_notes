# 修复网络配置及 Winsock 协议指南

## 操作步骤概览

### 1. 重置 Winsock 协议目录

**作用**：修复由损坏的 Winsock 配置导致的网络连接异常\
**操作步骤**：

1.  以管理员身份打开命令提示符\
2.  输入以下命令并回车执行：

``` batch
netsh winsock reset
```

3.  重启计算机使更改生效

### 2. 重置 IP 协议配置

**作用**：恢复网络适配器的默认 TCP/IP 设置\
**操作步骤**：

1.  以管理员身份运行命令提示符\
2.  执行以下命令（注意文件路径）：

``` batch
netsh int ip reset c:\catalog.txt
```

**注意**：

-   此操作会清除静态 IP/DNS 设置，恢复为 DHCP 自动获取\
-   `c:\catalog.txt` 为重置日志保存路径，可根据需要修改

### 3. 清除代理服务器设置

**作用**：解除可能影响网络连接的代理配置\
**操作步骤**：

``` batch
netsh winhttp reset proxy
```

**生效条件**：

-   立即生效，无需重启\
-   适用于 WinHTTP 组件的代理设置

### 4. 重置防火墙配置

**作用**：恢复 Windows 防火墙默认规则\
**执行命令**：

``` batch
netsh advfirewall reset
```

**影响说明**：

-   删除所有自定义防火墙规则\
-   恢复默认入站/出站规则\
-   建议提前备份重要规则

## 操作后验证

1.  依次执行所有命令后重启计算机\
2.  验证网络功能：
    -   检查 IP 获取情况（`ipconfig /all`）
    -   测试互联网连接
    -   验证代理设置是否清除

## 注意事项

1.  必须使用管理员权限运行命令提示符
2.  建议按顺序执行所有重置操作
3.  企业网络环境可能需要联系网管获取特殊配置
4.  重置防火墙后需重新配置特殊应用权限

> **重要提示**：这些操作会清除相关网络配置，执行前请确保：\
> - 记录重要的静态 IP/DNS 配置\
> - 备份防火墙例外规则\
> - 知晓当前网络环境的具体要求

------------------------------------------------------------------------

## **Winsock** 组件简介

**Winsock** 是 **Windows Socket API** 的简称，它是 Windows 操作系统中用于实现网络通信的核心组件。具体来说：

------------------------------------------------------------------------

### 核心功能

1.  **网络协议管理**\
    Winsock 是应用程序与 TCP/IP 协议栈之间的桥梁，负责：

    -   管理网络数据传输
    -   处理 IP 地址解析
    -   协调网络通信接口

2.  **标准化接口**\
    为开发者提供统一的编程接口（API），使应用程序无需直接操作底层协议即可实现网络通信。

3.  **协议扩展支持**\
    支持 TCP/IP、UDP、ICMP 等协议，并可扩展兼容其他网络协议。

------------------------------------------------------------------------

### 常见问题场景

当出现以下问题时，可能需要重置 Winsock：

-   🚫 网络连接显示正常但无法访问互联网
-   🚫 DNS 解析异常（如 `ping` 通 IP 但无法访问域名）
-   🚫 代理设置异常残留
-   🚫 防火墙/安全软件配置冲突

------------------------------------------------------------------------

### `netsh winsock reset` 的作用

执行该命令会：

1.  清除损坏的 Winsock 目录配置
2.  恢复默认的协议绑定设置
3.  重建网络组件注册表项
4.  修复因软件冲突或恶意程序导致的协议栈异常

------------------------------------------------------------------------

### 技术细节

-   **影响范围**：LSP（分层服务提供商）相关的网络组件
-   **重置后需**：**必须重启系统**才能使更改生效
-   **关联组件**：与 `TCP/IP 协议栈`、`WinHTTP` 共同构成 Windows 网络通信基础

建议在以下情况后执行重置操作：

1.  网络驱动更新失败
2.  安装/卸载 VPN 软件后
3.  遭遇网络类恶意软件攻击后
